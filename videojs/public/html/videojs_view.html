<div class="videojs_block">
    <h2>{{ display_name }}</h2>
    <video class="video-js vjs-default-skin vjs-controls-enabled vjs-has-started vjs-fullscreen vjs-user-active vjs-scrubbing vjs-paused" controls preload autoplay width="100%" height="400" id="video-js{{ id }}">
        <source src="{{ url }}" type="video/mp4">
        <track kind="captions" src="{{ subtitle_url }}" srclang="en"
               label="English" default>
        <p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that
            <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>
    </video>

    {% if allow_download or source_url != "" %}
    <ul>
        {% if allow_download %}
        <li class="video-download-button">
            <a href="{{ url }}" download>Download the video</a>
        </li>
        {% endif %}
        {% if source_url != "" %}
        <li class="video-download-button">
            <a href="{{ source_url }}" download>{% if source_text == "" %}Download the source document{% else %}{{
                source_text }}{% endif %}</a>
        </li>
        {% endif %}
    </ul>
    {% endif %}
</div>


<script>
  $( document ).ready(function() {
    parent.postMessage(JSON.stringify({action:'getMuted'}),'*');

    $('video')[0].play();


    function handleIframeMessage(event) {
      var message = JSON.parse(event.data);
      switch (message.action) {
        case 'mute':
          $('video')[0].muted = true;
          break;

        case 'unmute':
          $('video')[0].muted = false;
          break;
      }
    }
    window.addEventListener('message', handleIframeMessage, false);

  });
</script>

